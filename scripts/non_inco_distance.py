###### Grab the distance to Melbourne Central Station from the properties in SA2 district with no income specified
####### in our income dataset 

import openrouteservice as ors
import time
import csv

gpd_non_inco = pd.read_csv('../data/curated/domain_non_income.csv')

####### 0--860 #######

ors_key = "5b3ce3597851110001cf6248096baaa368004ce99a11a6c3920705db"
client = ors.Client(key=ors_key)

non_inco_distance = []

a = 0

while a < int(len(gpd_non_inco)/20):
    k = a*20
    for i, row in gpd_non_inco.iloc[k:k+20].iterrows():
        x = row['geometry'].x
        y = row['geometry'].y
        coor = [[x, y],[144.9628,-37.8102]]
        route = client.directions(coordinates=coor, profile='driving-car',format='geojson')
        dis = route['features'][0]['properties']['segments'][0]['distance']*0.000621371*1.60934
        non_inco_distance.append(dis)
    time.sleep(30)
    a+=1
    
####### 860--874 #######

non_inco_distance = [1.56749561905695,1.6149954863011002,1.2116966134681382,2.021094351308454,1.34099625209274,1.217296597816922,1.3603961978724561,1.505095793456214,1.1613967540495962,1.6381954214603482,0.9949972191143001,1.470195890996828,0.635598223586984,0.8112977325300819,0.8062977465043819,0.9111974533235682,1.264596465620044,0.851597619897224,1.3118963334231661,2.63899262436446,2.703392444375476,2.1398940192790863,1.0299971212942,3.139591225257544,2.053894259637046,2.621592672995024,1.337296262433722,1.4003960860780562,2.634292637500302,2.7028924457729064,2.634292637500302,2.217893801280006,2.7703922571198563,3.208091033809634,1.830294884567742,1.6886952803199182,2.5911927579587677,2.0346943132983584,3.16849114448609,2.801592169920224,1.927094614025294,1.0653970223561562,0.824797694799472,2.064194230849988,1.444795961986272,2.2182938001620625,2.3284934921684903,2.4342931964723022,1.625295457514042,2.146694000274038,2.1903938781386563,2.291693595019338,1.625295457514042,1.4011960838421682,1.651295384847682,2.139094021514974,2.35799340972012,2.362693396584278,2.3663933862432964,1.625295457514042,1.5058957912203261,5.967383321952435,6.0245831620864445,5.74548394213187,6.210282643080943,6.026283157335182,5.93648340831361,7.46647913217781,7.8639780212209605,7.625078688913014,7.644178635531189,7.45247917130585,8.400276522337542,6.701181271084168,9.402373721608335,9.269774092206772,8.35417665118059,6.701181271084168,7.4678791282650065,7.879377978180115,8.4056765072453,3.18449109976833,3.1498911964704863,4.076588606473724,4.02398875348336,3.9375889949592637,3.7649894773521,3.7486895229083177,3.381590548901424,5.29448520261373,3.19399107321716,3.566890031013866,3.952388953595336,3.91748905113595,4.070688622963398,4.432887610665106,3.81198934599368,3.9150890578436135,5.235185368348928,2.7537923035145324,3.23299096421762,2.91049186555997,2.543292891832562,2.6806925078187978,3.23299096421762,2.757192294012008,3.23299096421762,2.742292335655422,3.107191315811008,2.7537923035145324,2.6542925816031024,2.4869930491831798,2.654392581323616,2.98049166991977,3.273790850187332,2.951891749852766,3.121891274726566,2.93799178870132,2.654392581323616,2.98049166991977,26.56312575957485,27.319623645263263,28.004021732461073,25.455028856559213,39.84548863712638,38.82759148201438,40.346787236063065,38.830991472511855,36.286098585151066,37.89529408766236,34.95360230930201,35.5549006287527,38.93289118771562,41.308484548246206,41.28858460386391,38.11199348201619,38.71649179252332,35.750500082078084,38.39289269694002,42.57738100184835,42.18388210162576,26.20362676432702,24.62293118216222,25.131229761534883,25.08792988255232,25.639528340907543,24.47163160502454,24.65263109915488,24.258832199770747,26.87842487835549,24.92623033448118,33.41580660723773,33.48600641103855,33.48600641103855,34.54180346022537,30.84761378499718,26.245426647501873,24.91943035348623,25.14032973610166,30.335615215965497,32.83940821819503,31.737711297292293,31.360812350675026,33.82260547028868,13.802461423944848,16.666553419186325,12.53376496978373,13.43976243764057,16.58025366038274,15.809055815778773,16.417154116224406,13.382362598065535,13.170063191414314,16.282354492971535,14.761958742276681,13.009563639989345,14.225860240601126,13.568562077662603,13.629561907176145,15.83415574562779,14.386059792864554,13.374762619306471,15.901855556415764,13.316262782805783,11.78116707319537,11.80516700611873,11.369568223559744,12.256865743680466,13.329762745075172,11.75346715061299,14.166760405777351,13.099563388451942,12.247365770231635,12.206665883982438,11.836366918919095,11.836366918919095,12.04766632836518,11.016369210704296,12.217865852680006,12.365665439599699,13.12846330768049,12.40826532053866,11.86546683758867,12.336465521209611,28.091121489028765,31.375812308752124,27.91832197198058,29.525617479802097,28.406820606691465,29.07371874279933,27.204923965833704,8.881875176332965,8.881875176332965,8.881875176332965,8.881875176332965,8.655275809648241,8.02147758103051,8.881875176332965,8.513776205120932,7.698878482652345,8.04397751814616,7.970577723288884,9.719572835078743,9.901372326973195,10.464770752349072,9.696072900757954,9.734972792037901,9.020474788965371,10.646270245081983,9.824672541338959,9.134274470910302,10.016372005564296,10.191571515904824,10.747069963360094,16.06775509274849,10.191571515904824,10.77676988035275,11.181568748993424,10.770369898239856,11.208168674650148,12.064266281970502,12.556664905781439,11.805767004441812,12.45146519980071,13.381462600580909,11.576667644744239,11.530867772748826,10.459870766043885,11.581067632446855,11.527567781971864,10.801269811878681,12.40016534317703,12.209565875877345,12.040966347090741,12.068266270791062,11.86046685156297,12.02826638258546,12.958863781688745,13.232063018132996,13.672861786158705,14.171960391244081,13.54146215340331,13.641561873637823,13.963260974531362,14.136360490741096,14.17896037168006,7.250879734749626,6.928280636371461,6.400182112337028,6.679081332850574,7.2860796363705544,7.126780081591752,5.41598486303824,4.670386946885856,4.76898667131266,4.653286994677963,4.930986218545341,4.734386768014816,5.154385594173616,4.518187372263547,4.510387394063456,5.061885852698166,4.220188205131827,4.6848869063603855,5.505884611780325,5.138685638052918,4.321587921733024,4.670386946885856,8.227377005568835,9.077774628819892,6.3949821268703,7.13698005308418,8.083677407190217,9.549573310204945,9.096674575997039,7.13698005308418,6.995380448836356,7.495079052244814,9.37347380237979,8.343376681365076,10.542070536306396,9.635273070685441,9.87597239796264,8.683475730833191,9.56967325402826,36.73399733333327,27.67152266175202,38.24649310610752,28.190421211499167,34.96140228750211,35.44260094261547,8.221877020940566,6.959580548892345,7.410779287851512,6.888180748445348,7.230379792044255,8.45977635604337,6.683181321391648,5.54298450809102,5.750583927878084,7.070780238103912,7.420079261859314,6.177182735590808,6.8770807794682955,7.090780182206713,6.979980491877201,7.122380093889136,5.704684056162158,6.398582116808804,6.853880844309046,13.148363252062776,13.210663077943,13.214163068160987,11.69046732668917,11.834666923670358,11.095168990469329,12.854364073751617,11.363168241446848,13.487262304884721,12.178565962518006,13.53746216458275,13.333862733616245,12.622564721600165,15.623056335622733,14.210360283921455,14.215060270785616,14.26146014110411,14.3806598079568,15.654056248982073,18.386848611188668,18.79764746306018,19.82224459944662,18.521348235279998,17.959049806829775,19.70364493091702,19.08264666652508,19.510645470325,20.401842979545766,17.973249767142764,17.25945176211383,18.76294756004182,17.92694989654478,17.92694989654478,17.92694989654478,19.646345091062496,18.074549484023443,18.762747560600793,19.06484671627359,19.180846392069828,19.09144664193031,8.229476999699632,8.859775238099372,9.11697451926138,7.532178948555507,7.624678690030958,7.218379825582576,9.861772437649652,8.878375186114976,8.265776898246212,7.053680285896019,9.940272218253142,8.250276941566542,8.913375088294876,8.91117509444357,7.1842799208873025,9.27347408186579,8.118377310208576,6.973180510882249,9.27347408186579,7.493579056437104,9.347773874207691,3.837389275004236,4.939486194789031,4.0949885550483005,3.768089468688034,3.8718891785815663,4.62848706399049,4.098188546104748,3.305190762428728,6.51198179987168,6.484881875612385,4.62648706958021,5.09148576997031,5.580284403842742,4.581687194789938,5.311285155660082,4.858686420613719,4.303287972878962,4.581687194789938,4.35448782978213,3.8021893733833076,7.904277908588103,6.329282310492602,5.870083593892314,6.11148291921311,7.345479470355871,7.26597969254724,7.540178926196628,6.19948267326543,7.402379311328335,7.839878088577086,7.645278632456842,7.635678659287498,7.679178537711088,7.586378797074096,7.679178537711088,8.314776761298072,7.219779821669772,7.059080270803774,5.462884731959306,5.070085829780314,5.247185334810608,6.020683172986398,5.035885925364526,5.274085259628874,6.09448296672573,5.561784455547652,5.070085829780314,6.057183070974008,7.233679782821218,6.200282671029543,6.405182098362728,22.856036120400354,23.752133615926308,26.1763268406267,23.91763315337698,23.716233716261783,24.01483288171659,24.483631571486217,21.771939150308082,21.357340309057037,23.499834321069486,24.208232341190662,23.306534861315924,24.162232469754223,22.603936824984558,22.696336566739497,22.127838155617408,22.64173671933885,21.97433858462842,23.927033127105293,37.91659402813183,37.36649556558432,37.71739458486795,39.18289048900062,37.766494447640326,39.17909049962109,38.76869164663164,37.62609484003866,36.206698807062956,37.20499601695421,36.551997841997796,37.025596518352096,37.09079633612723,38.24599310750495,37.84059424054119,36.21479878442459,38.83029147446826,38.689891866866596,37.05159644568574,36.60399769666507,34.08520473635844,34.35390398537956,34.32650406195872,33.0199077137228,34.32650406195872,33.51330633473888,36.13479900801339,36.00239937805285,37.90049407312908,8.042377522617935,7.228279797913462,7.131080069573854,6.318682340118118,7.327179521501807,6.982880483772106,7.390279345146143,7.4786790980805185,7.804378187794616,8.038177534356349,3.8572892193865225,3.8587892151942325,3.7725894561111644,3.82848929987849,71.33590062558757,70.29240354202398,65.9669156311909,65.67111645791049,65.49081696182374,65.75201623180631,65.75241623068837,66.51731409289995,70.12010402357835,66.65221371587333,65.83071601185082,67.18011224046674,67.60131106327171,68.21020936148145,67.72231072509365,67.12361239837632,67.11971240927627,67.6641108877545,67.10671244560946,68.24390926729468,67.42201156439012,68.30040910938509,87.4018557233668,87.81525456797168,86.18825911520888,89.11895092431268,86.81695735808042,90.57664685024525,90.62534671413559,90.77644629183224,90.08104823537789,89.96234856712776,88.90345152660501,90.8854459871925,90.1054481671833,95.0554343326263,90.18504794471245,89.91294870519386,95.52863301009853,90.05484830860323,92.23714220938022,90.21864785080514,94.53633578343813,91.00364565684004,94.65353545588054,94.50193587958131,97.37722784352036,92.67834097628801,105.80480428955823,108.22159753494057,107.24070027641875,107.98559819452753,107.87269851006722,108.44919689883042,103.08341189549022,108.57549654583963,107.83799860704887,107.37279990721774,108.45999686864593,108.1283977954215,108.08219792454405,107.59169929542288,101.76871556989266,106.31940285132326,107.25230024399838,104.36130832393864,112.32568606455565,103.78700992902672,102.78091274093536,104.22220871270365,106.03030365931728,103.4011110075632,112.07998675125275,103.44551088347141,106.07630353075375,102.54711339437364,101.82961539968568,103.62651037760176,111.10528947540278,104.76610719257928,101.62691596620381,102.75131282366323,37.692894653342016,37.63829480594138,39.85808860191114,33.47400644457687,35.21330158347688,37.92569400269861,40.20188764103828,40.16478774472759,37.39309549124105,36.52829790823598,36.87889692835806,35.96689947727038,46.87076900239643,44.327076111681805,45.2062736544409,44.36227601330274,46.24657074694804,45.81317195824037,46.32897051665157,44.982474279930564,46.70546946438679,45.40897308792277,45.17477374247899,47.46856733162911,46.257570716204576,48.61216413542723,47.22966799932117,49.31526217036116,46.64926962145792,46.32757052056438,48.18406533190679,48.20936526119683,47.620866905971944,46.46937012425323,48.774063682939385,53.08295164016714,52.67425278242642,44.545675500725416,45.095773963272926,44.24187634980388,45.08157400295993,45.352073246950305,46.81396916114448,48.74406376678518,47.08676839870667,113.11458385969057,111.17438928227794,113.43548296282,115.55047705169112,115.11627826521934,114.63497961038544,117.35827199914323,114.87327894437031,115.76367645582697,115.47247726969019,118.41096905699408,117.47717166683434,120.406863478733,119.84426505112125,119.7546653015407,119.90446488287068,120.24936391892345,119.39646630265956,119.4711660938835,118.08856995805695,119.96286471965085,119.58236578309507,119.1590669661593,118.70266824173342,119.24716671993214,119.09956713245349,36.96469668855907,36.55299783920294,36.26299864971233,34.412903820482825,36.80499713489821,34.70360300801701,36.65399755692207,36.61869765558063,36.98259663853108,36.98259663853108,34.694503033450246,39.62428925534942,39.17099052225945,39.19869044484184,39.68608908262706,42.064282435891016,39.96658829866883,43.329978898436714,43.94047719217468,42.775080449304525,39.8312886768134,180.32759600820643,181.08359389529227,181.86479171194762,180.78439473151437,180.34299596516558,181.0194940744428,174.76461155601262,177.1916047728874,177.7354032530425,176.977905370149,311.0759305838948,311.1876302717089,310.0287335106721,313.9804224662239,313.006325188697,313.455923932128,311.2086302130168,311.1507303748392,312.7112260134602,312.87182556460573,311.885128322294,313.34782423425236,310.60393190306866,315.1936190754997,320.43710442065134,315.11121930579617,315.4531183502335,314.26012168450154,321.11090253747466,319.79030622836683,322.2297994103058,29.83961660221606,30.05611599712887,29.43521773245744,29.917716383937496,30.83221382803802,29.824316644977422,30.17041567767637,31.17271287638819,30.722914133516216,33.01980771400228,31.098113084884748,31.23751269528126,32.79410834480219,31.999310566156918,31.778211184100464,34.806102721543866,34.57640336352321,34.98830221232038,32.7363085063451,32.09781029086321,48.280265063041256,51.62955570221665,52.126454313450715,52.2362540065751,49.38006198925422,50.636958476394696,47.54766711055569,46.91756887159698,46.539269928892516,47.825466334143584,52.16855419578711,51.97375474022584,52.35405367734059,51.94185482938188,48.135965466339556,48.34656487774204,54.32844815916901,55.34604531511947,55.74184420891388,55.59524461864036,54.83034675642877,53.984949119203414,53.98334912367519,52.84905229388489,53.399450755593946,53.25655115497944,52.69815271562926,53.08355163849021,53.89314937577156,54.52504760969952,52.41085351859253,52.490853295003745,54.456247801985896,52.70465269746268,57.02514062227005,59.11653477709983,56.23724282434024,56.19114295318328,75.50658896906496,75.00079038270515,73.9119934257487,73.53209448751602,87.306955988599,88.40865290950174,63.7698217717778,62.30112587658869,62.46042543136749,58.05633774021041,58.0176378483715,60.664730450097586,61.89722700543265,57.72323867117829,60.34353134780662,60.60263062365839,56.67554159935309,60.71253031650328,63.49362254371814,61.86772708788101,59.99003233578963,61.378428455405995,62.51142528882962,59.93813248084286,74.37289213759774,80.3668753852069,82.51306938687837,163.15734399679107,164.07674142719682,164.85623924860346,165.53083736319087,162.64234543614398,163.30394358706462,163.83644209880165,162.3357462930481,162.31074636291956,161.6487482131169,161.50054862731514,161.97484730171303,163.76944228605728,163.5400429271982,164.34714067146666,164.39274054402105,165.4194376745383,165.77583667845016,165.5844372133864,165.34633787884255,74.26199244754771,73.69009404592815,71.78319937544667,73.53209448751602,72.22379814403136,71.44570031871191,73.58719433351924,70.79820212838376,74.39829206660829,75.17108990674048,72.57239716974317,74.95889049980978,71.2169009581759,71.57419995957241,70.98200161468851,75.27148962613653,75.41388922814848,72.82509646348204,40.96968549514477,43.47887848228206,40.84878583304335,43.16357936350142,41.73598335344356,41.34998443225951,40.742186130975426,41.974982685472014,41.78868320615443,41.512483978094764,41.967082707551405,41.74818331934626,44.64607522012147,44.69527508261436,43.18027931682726,44.57467541967447,43.70377785371805,45.57247263096316,42.16318215947936,43.57737820698835,46.83966908931657,49.66996117902431,48.47456451999996,45.811171963830084,53.23975120193309,54.58344744647971,54.24864838219884,50.51195882575219]


a = 860

for i, row in gpd_non_inco.iloc[a:].iterrows():
        x = row['geometry'].x
        y = row['geometry'].y
        coor = [[x, y],[144.9628,-37.8102]]
        route = client.directions(coordinates=coor, profile='driving-car',format='geojson')
        dis = route['features'][0]['properties']['segments'][0]['distance']*0.000621371*1.60934
        non_inco_distance.append(dis)
        
with open('../data/curated/non_inco_distance_list', 'w') as f:
      
    # using csv.writer method from CSV package
    write = csv.writer(f)
      
    write.writerow(non_inco_distance)